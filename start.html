<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Start Your AI Story</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <main class="hero" style="max-width: 600px; margin: 2rem auto; text-align: center;">
    <h2>üéôÔ∏è Begin Your AI Journey</h2>
    <form id="story-form">
      <input type="text" id="userName" placeholder="Your name" required /><br><br>

      <select id="language" required>
        <option value="">Select language</option>
        <option value="English">English</option>
        <option value="Spanish">Spanish</option>
        <option value="French">French</option>
        <option value="Danish">Danish</option>
      </select><br><br>

      <select id="level" required>
        <option value="">Select your level</option>
        <option value="beginner">Beginner</option>
        <option value="intermediate">Intermediate</option>
        <option value="expert">Expert</option>
      </select><br><br>

      <select id="voice" required>
        <option value="">Select voice</option>
        <option value="EXAVITQu4vr4xnSDxMaL">Rachel (Example Female)</option>
        <option value="21m00Tcm4TlvDq8ikWAM">Default Male</option>
      </select><br><br>

      <button type="submit" class="cta-btn">Generate & Listen ‚Üí</button>
    </form>

    <div id="response" style="margin-top: 2rem;"></div>
    <audio id="audio" controls style="margin-top: 1rem; display: none;"></audio>
  </main>

  <script>
    function getTedStylePrompt(module, userName, language, level) {
      const themes = {
        English: {
          title: "AI Is Not Coming for Your Job ‚Äî But Someone Who Uses It Might",
          idea: "Most people fear AI because they don‚Äôt understand it. Learning a little can give you a big edge.",
          opening: "What if I told you AI is already part of your life?",
          structure: [
            "AI is like electricity ‚Äî scary at first, then everywhere.",
            "Fear comes from not knowing. You don‚Äôt have to be technical.",
            "Real people are using AI to create, solve, and grow.",
            "AI doesn‚Äôt replace us ‚Äî it amplifies what makes us human."
          ],
          ending: "The real question isn‚Äôt if AI will change your world ‚Äî it‚Äôs how you‚Äôll shape it."
        },
        Spanish: {
          title: "La IA No Te Va a Reemplazar ‚Äî Pero Alguien Que La Use, S√≠",
          idea: "La mayor√≠a teme a la IA porque no la entiende. Aprender un poco te da ventaja.",
          opening: "¬øY si te dijera que ya usaste IA hoy?",
          structure: [
            "La IA es como el correo electr√≥nico ‚Äî al principio da miedo.",
            "El miedo viene del desconocimiento.",
            "Gente real ya la est√° usando para avanzar.",
            "La IA amplifica tu humanidad, no la reemplaza."
          ],
          ending: "La IA ya cambi√≥ el mundo. ¬øLa usar√°s t√∫ o la usar√° otro por ti?"
        },
        French: {
          title: "L‚ÄôIA Ne Vous Remplacera Pas ‚Äî Mais Quelqu‚Äôun Qui L‚ÄôUtilise, Oui",
          idea: "Beaucoup ont peur de l‚ÄôIA parce qu‚Äôils ne la comprennent pas. Un peu de savoir change tout.",
          opening: "Et si je vous disais que l‚ÄôIA fait d√©j√† partie de votre journ√©e ?",
          structure: [
            "L‚ÄôIA est comme Internet ‚Äî elle fait peur au d√©but.",
            "La peur vient du flou.",
            "Des gens normaux l‚Äôutilisent d√©j√† pour mieux travailler.",
            "L‚ÄôIA aide √† √™tre plus humain, pas moins."
          ],
          ending: "L‚ÄôIA est l√†. Allez-vous l‚Äôutiliser ‚Äî ou rester spectateur ?"
        },
        Danish: {
          title: "AI Kommer Ikke For Dit Job ‚Äî Men En Der Bruger Det, G√∏r",
          idea: "Folk frygter AI, fordi de ikke forst√•r det. Lidt viden kan give dig meget.",
          opening: "Hvad hvis jeg sagde, du allerede har brugt AI i dag?",
          structure: [
            "AI er som elektricitet ‚Äî skr√¶mmende i starten, uundg√•eligt bagefter.",
            "Frygt opst√•r, n√•r vi ikke forst√•r.",
            "Helt almindelige mennesker bruger AI allerede.",
            "AI fjerner ikke det menneskelige ‚Äî det forst√¶rker det."
          ],
          ending: "Sp√∏rgsm√•let er ikke om AI √¶ndrer verden ‚Äî men hvordan du vil v√¶re en del af det."
        }
      };

      const content = themes[language] || themes["English"];
      return `${content.opening}\n\n${content.idea}\n\n${content.structure.join("\n")}\n\n${content.ending}`;
    }

    const form = document.getElementById('story-form');
    const audio = document.getElementById('audio');
    const responseBox = document.getElementById('response');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const userName = document.getElementById('userName').value;
      const language = document.getElementById('language').value;
      const level = document.getElementById('level').value;
      const voice = document.getElementById('voice').value;
      const module = "what_is_ai";

      const tedScript = getTedStylePrompt(module, userName, language, level);

      responseBox.innerText = "‚è≥ Generating your story...";
      audio.style.display = "none";

      try {
        const storyRes = await fetch('/generate-story', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ userName, language, level, module, voice })
        });

        const { story } = await storyRes.json();
        const finalStory = story || tedScript;
        responseBox.innerText = finalStory;

        const audioRes = await fetch('/narrate', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ text: finalStory, voice })
        });

        const audioBlob = await audioRes.blob();
        audio.src = URL.createObjectURL(audioBlob);
        audio.style.display = 'block';
        audio.play();
      } catch (err) {
        console.error(err);
        responseBox.innerText = "‚ö†Ô∏è Error: " + err.message;
      }
    });
  </script>
</body>
</html>
